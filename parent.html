<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Parent Portal â€” Blooming Kids House</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" />
    <link rel="icon" href="favicon.ico" />
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Firebase SDKs (in correct order) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    
    <!-- Your Firebase config -->
    <script src="firebaseParentConfig.js"></script>

    <!-- Other libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    
    <!-- Global Phone Number Support -->
    <script src="https://cdn.jsdelivr.net/npm/libphonenumber-js@1.9.6/bundle/libphonenumber-js.min.js"></script>

    <style>
        :root {
            --primary: #059669;
            --primary-dark: #065f46;
            --primary-light: #ecfdf5;
            --primary-mid: #d1fae5;
            --accent: #f59e0b;
            --surface: #ffffff;
            --surface-2: #f8faf9;
            --border: #e2e8f0;
            --text-main: #0f172a;
            --text-muted: #64748b;
            --radius-lg: 20px;
            --radius-xl: 28px;
            --shadow-sm: 0 2px 8px rgba(0,0,0,.06);
            --shadow-md: 0 8px 28px rgba(0,0,0,.10);
            --shadow-lg: 0 20px 60px rgba(0,0,0,.14);
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'DM Sans', sans-serif;
            background: #f0faf6;
            min-height: 100vh;
            color: var(--text-main);
        }

        /* Animated mesh background */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background:
                radial-gradient(ellipse 80% 50% at 10% 0%, rgba(16,185,129,.12) 0%, transparent 60%),
                radial-gradient(ellipse 60% 60% at 90% 100%, rgba(5,150,105,.10) 0%, transparent 60%),
                radial-gradient(ellipse 50% 40% at 50% 50%, rgba(209,250,229,.3) 0%, transparent 70%);
            pointer-events: none;
            z-index: 0;
        }

        body > * { position: relative; z-index: 1; }

        h1, h2, .font-serif { font-family: 'Playfair Display', serif; }

        /* â”€â”€â”€ HIDDEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .hidden { display: none !important; }

        /* â”€â”€â”€ CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .card {
            background: var(--surface);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(255,255,255,.8);
        }

        /* â”€â”€â”€ AUTH TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .auth-tab-active {
            background: var(--primary);
            color: #fff;
            border-radius: 12px;
        }
        .auth-tab-inactive {
            background: transparent;
            color: var(--primary);
        }

        /* â”€â”€â”€ MAIN TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .tab-active-main {
            background: var(--primary);
            color: #fff;
            box-shadow: 0 4px 14px rgba(5,150,105,.35);
        }
        .tab-inactive-main {
            background: transparent;
            color: var(--primary-dark);
        }
        .tab-inactive-main:hover {
            background: var(--primary-mid);
        }

        /* â”€â”€â”€ BUTTONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            color: #fff;
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-weight: 700;
            font-family: 'DM Sans', sans-serif;
            cursor: pointer;
            transition: transform .2s, box-shadow .2s, opacity .2s;
            box-shadow: 0 4px 14px rgba(5,150,105,.3);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(5,150,105,.4);
        }
        .btn-primary:active { transform: translateY(0); }

        /* â”€â”€â”€ INPUTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .input-styled {
            width: 100%;
            padding: 12px 16px;
            border: 1.5px solid var(--border);
            border-radius: 12px;
            font-size: 0.9rem;
            font-family: 'DM Sans', sans-serif;
            outline: none;
            transition: border-color .2s, box-shadow .2s;
            background: var(--surface);
        }
        .input-styled:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(16,185,129,.12);
        }
        /* For compatibility with old input-focus class */
        .input-focus:focus {
            box-shadow: 0 0 0 3px rgba(16,185,129,.12);
            border-color: var(--primary) !important;
        }

        /* â”€â”€â”€ SPINNERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .loading-spinner {
            border: 3px solid rgba(255,255,255,.3);
            border-top: 3px solid #fff;
            border-radius: 50%;
            width: 22px; height: 22px;
            animation: spin 0.8s linear infinite;
            display: inline-block;
            margin-right: 8px;
            vertical-align: middle;
        }
        .loading-spinner-small {
            border: 2px solid rgba(255,255,255,.3);
            border-top: 2px solid #fff;
            border-radius: 50%;
            width: 16px; height: 16px;
            animation: spin 0.8s linear infinite;
            display: inline-block;
            vertical-align: middle;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* â”€â”€â”€ TOAST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .toast {
            position: fixed; top: 20px; right: 20px;
            padding: 12px 20px; border-radius: 12px;
            color: #fff; font-weight: 600; z-index: 10000;
            box-shadow: var(--shadow-md);
            transform: translateX(130%);
            transition: transform .3s cubic-bezier(.34,1.56,.64,1);
            font-family: 'DM Sans', sans-serif;
        }
        .toast.show { transform: translateX(0); }
        .toast.success { background: linear-gradient(135deg, #059669, #10b981); }
        .toast.error   { background: linear-gradient(135deg, #dc2626, #ef4444); }
        .toast.warning { background: linear-gradient(135deg, #d97706, #f59e0b); }

        /* â”€â”€â”€ FADE IN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .fade-in { animation: fadeIn .5s ease; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(12px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        /* â”€â”€â”€ ACCORDIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .accordion-header { transition: all .25s ease; }
        .accordion-header:hover { transform: translateX(2px); }
        .slide-down {
            animation: slideDown .3s ease-out;
        }
        @keyframes slideDown {
            from { opacity: 0; max-height: 0; }
            to   { opacity: 1; max-height: 9999px; }
        }

        /* â”€â”€â”€ NOTIFICATION BADGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .notification-badge {
            position: absolute; top: -7px; right: -7px;
            background: #ef4444; color: #fff;
            border-radius: 9999px; font-size: 0.7rem; font-weight: 800;
            min-width: 1.2rem; height: 1.2rem;
            display: flex; align-items: center; justify-content: center;
            padding: 0 3px;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        /* â”€â”€â”€ ACADEMICS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .topic-item {
            transition: all .2s ease;
            border-left: 4px solid #3b82f6;
        }
        .topic-item:hover { transform: translateX(4px); }
        .homework-item {
            transition: all .2s ease;
            border-left: 4px solid #8b5cf6;
        }
        .homework-item:hover { transform: translateX(4px); }
        .status-overdue  { background:#fef2f2; color:#dc2626; border-color:#fca5a5; }
        .status-pending  { background:#eff6ff; color:#1d4ed8; border-color:#93c5fd; }
        .status-submitted{ background:#f0fdf4; color:#15803d; border-color:#86efac; }

        /* â”€â”€â”€ RESPONSE BUBBLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .response-bubble {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            border-radius: 12px;
            padding: 12px;
            margin-top: 8px;
        }
        .response-header { font-weight: 700; color: #065f46; margin-bottom: 4px; }
        .preserve-whitespace { white-space: pre-wrap; word-break: break-word; }

        /* â”€â”€â”€ WELCOME BANNER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .welcome-banner {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 60%, #34d399 100%);
            border-radius: var(--radius-lg);
            color: #fff;
            padding: 24px 28px;
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
        }
        .welcome-banner::after {
            content: '';
            position: absolute; inset: 0;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Ccircle cx='50' cy='50' r='40' fill='none' stroke='rgba(255,255,255,.06)' stroke-width='1'/%3E%3C/svg%3E") repeat;
            pointer-events: none;
        }

        /* â”€â”€â”€ MAIN TAB BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .main-tab-bar {
            display: flex;
            background: var(--surface);
            border-radius: 16px;
            padding: 6px;
            gap: 4px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border);
            margin-bottom: 24px;
            overflow-x: auto;
        }
        .main-tab-bar button {
            flex: 1;
            min-width: max-content;
            padding: 10px 16px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 0.85rem;
            border: none;
            cursor: pointer;
            transition: all .2s ease;
            white-space: nowrap;
            font-family: 'DM Sans', sans-serif;
        }

        /* â”€â”€â”€ AUTH CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .auth-card {
            background: rgba(255,255,255,.97);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(209,250,229,.6);
            padding: 40px;
        }

        /* â”€â”€â”€ LOGO GLOW (kept for compat) â”€ */
        .logo-glow { filter: drop-shadow(0 0 20px rgba(16,185,129,.25)); }
        .card-glow  { box-shadow: var(--shadow-md); }
        .btn-glow   { box-shadow: 0 4px 14px rgba(5,150,105,.25); transition: all .25s ease; }
        .btn-glow:hover { transform: translateY(-2px); box-shadow: 0 8px 22px rgba(5,150,105,.35); }

        /* â”€â”€â”€ SCROLLBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 4px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* â”€â”€â”€ URGENT MESSAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .urgent-message { border-left: 4px solid #ef4444; background: #fef2f2; }

        /* â”€â”€â”€ SECTION HEADING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-dark);
            margin-bottom: 20px;
        }

        /* â”€â”€â”€ ACADEMICS STUDENT SELECTOR â”€â”€ */
        .academics-student-selector {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: #fff;
            border-radius: 14px;
            padding: 1.25rem 1.5rem;
            margin-bottom: 1.5rem;
        }

        /* â”€â”€â”€ PRIVACY BANNER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        #privacyCookieBanner {
            font-family: 'DM Sans', sans-serif;
        }
    </style>
</head>
<body class="flex flex-col items-center p-4 md:p-6">
    <div id="toastContainer"></div>

    <div class="w-full max-w-6xl">

        <!-- â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â• -->
        <div class="text-center mb-8 pt-4">
            <img src="https://res.cloudinary.com/dy2hxcyaf/image/upload/v1757700806/newbhlogo_umwqzy.svg" 
                 alt="Blooming Kids House Logo" 
                 class="h-20 w-auto mx-auto logo-glow mb-4">
            <h1 class="text-4xl font-bold text-green-900 mb-1" style="font-family:'Playfair Display',serif;">Parent Portal</h1>
            <p class="text-green-700 text-base">Secure access to your children's progress &amp; reports</p>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â• AUTH AREA â•â•â•â•â•â•â•â•â•â• -->
        <div id="authArea" class="auth-card mb-8 fade-in max-w-md mx-auto">
            <!-- Auth Tab Toggle -->
            <div class="flex mb-6 rounded-xl overflow-hidden border border-green-100 bg-green-50 p-1 gap-1">
                <button id="signInTab" class="flex-1 py-2.5 font-bold rounded-xl auth-tab-active transition-all duration-200">
                    Sign In
                </button>
                <button id="signUpTab" class="flex-1 py-2.5 font-bold rounded-xl auth-tab-inactive transition-all duration-200">
                    Sign Up
                </button>
            </div>

            <!-- Sign In Form -->
            <div id="signInForm">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center" style="font-family:'Playfair Display',serif;">Welcome Back</h2>
                
                <div class="space-y-4">
                    <div>
                        <label for="loginIdentifier" class="block text-sm font-semibold text-gray-700 mb-2">Phone Number or Email</label>
                        <input id="loginIdentifier" type="text" placeholder="Enter your phone number or email"
                               class="input-styled" required>
                    </div>
                    <div>
                        <label for="loginPassword" class="block text-sm font-semibold text-gray-700 mb-2">Password</label>
                        <input id="loginPassword" type="password" placeholder="Enter your password"
                               class="input-styled" required>
                    </div>
                    <div class="flex items-center">
                        <input id="rememberMe" type="checkbox" class="h-4 w-4 accent-green-600">
                        <label for="rememberMe" class="ml-2 text-sm text-gray-600">Remember me</label>
                    </div>
                    <button id="signInBtn" class="btn-primary w-full py-3 flex justify-center items-center">
                        <span id="signInText">Sign In</span>
                        <div id="signInSpinner" class="loading-spinner hidden"></div>
                    </button>
                    <div class="text-center">
                        <button id="forgotPasswordBtn" class="text-green-600 hover:text-green-800 text-sm font-semibold transition-colors">
                            Forgot Password?
                        </button>
                    </div>
                </div>
            </div>

            <!-- Sign Up Form -->
            <div id="signUpForm" class="hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center" style="font-family:'Playfair Display',serif;">Create Account</h2>
                
                <div class="space-y-4">
                    <div>
                        <label for="signupPhone" class="block text-sm font-semibold text-gray-700 mb-2">Phone Number</label>
                        <div id="phoneInputContainer">
                            <input id="signupPhone" type="tel" placeholder="Enter your phone number"
                                   class="input-styled" required>
                        </div>
                    </div>
                    <div>
                        <label for="signupEmail" class="block text-sm font-semibold text-gray-700 mb-2">Email Address</label>
                        <input id="signupEmail" type="email" placeholder="Enter your email address"
                               class="input-styled" required>
                    </div>
                    <div>
                        <label for="signupPassword" class="block text-sm font-semibold text-gray-700 mb-2">Password</label>
                        <input id="signupPassword" type="password" placeholder="Minimum 6 characters"
                               class="input-styled" required minlength="6">
                    </div>
                    <div>
                        <label for="signupConfirmPassword" class="block text-sm font-semibold text-gray-700 mb-2">Confirm Password</label>
                        <input id="signupConfirmPassword" type="password" placeholder="Confirm your password"
                               class="input-styled" required minlength="6">
                    </div>

                    <!-- Privacy Consent -->
                    <div class="bg-green-50 border border-green-200 rounded-xl p-3">
                        <label class="flex items-start gap-2 cursor-pointer text-sm text-green-900 leading-relaxed">
                            <input type="checkbox" id="signup-privacy-consent" class="mt-0.5 flex-shrink-0 accent-green-600">
                            <span>I agree to the <a href="#" onclick="showPrivacyPolicy();return false;" class="font-bold underline text-green-700">Privacy Policy</a> and consent to Blooming Kids House collecting my data in accordance with NDPA, GDPR, and COPPA.</span>
                        </label>
                    </div>

                    <button id="signUpBtn" class="btn-primary w-full py-3 flex justify-center items-center">
                        <span id="signUpText">Create Account</span>
                        <div id="signUpSpinner" class="loading-spinner hidden"></div>
                    </button>
                </div>
            </div>
            
            <div id="authLoader" class="hidden text-center mt-4">
                <div class="loading-spinner" style="border-color:rgba(16,185,129,.3);border-top-color:#059669;"></div>
                <p class="text-green-700 font-semibold mt-2 text-sm">Processingâ€¦ Please wait.</p>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â• DASHBOARD AREA â•â•â•â•â•â•â•â•â•â• -->
        <div id="reportArea" class="hidden fade-in">

            <!-- Welcome Banner -->
            <div class="welcome-banner mb-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 relative z-10">
                    <div>
                        <p class="text-green-200 text-sm font-semibold uppercase tracking-widest mb-1">Blooming Kids House</p>
                        <h2 id="welcomeMessage" class="text-2xl md:text-3xl font-bold mb-1" style="font-family:'Playfair Display',serif;">Welcome!</h2>
                        <p class="text-green-100 text-sm">Thank you for being part of our family</p>
                    </div>
                    <div class="flex flex-col sm:flex-row gap-2 w-full md:w-auto" id="dashboard-action-btns">
                        <button onclick="logout()" 
                                class="bg-white bg-opacity-15 border border-white border-opacity-25 text-white px-5 py-2.5 rounded-xl font-bold hover:bg-opacity-25 transition-all flex items-center justify-center gap-2">
                            ğŸšª Logout
                        </button>
                    </div>
                </div>
            </div>

            <!-- â”€â”€ Main Tab Bar â”€â”€ -->
            <div class="main-tab-bar">
                <button id="reportTab" class="tab-active-main">
                    ğŸ“„ Progress Reports
                </button>
                <button id="academicsTab" class="tab-inactive-main">
                    ğŸ“š Academics
                </button>
                <button id="rewardsTab" class="tab-inactive-main">
                    ğŸ Rewards
                </button>
                <button id="enrollTab" class="tab-inactive-main">
                    â• Enroll Student
                </button>
            </div>

            <!-- â”€â”€ Reports Tab â”€â”€ -->
            <div id="reportContentArea">
                <h2 class="section-title">Your Children's Reports</h2>
                
                <div id="reportsLoading" class="hidden text-center py-10">
                    <div class="loading-spinner" style="border-color:rgba(16,185,129,.2);border-top-color:#059669;width:40px;height:40px;border-width:4px;"></div>
                    <p class="text-green-700 font-semibold mt-4">Loading reportsâ€¦</p>
                </div>
                
                <div id="reportsEmpty" class="hidden text-center py-14 card">
                    <div class="text-6xl mb-4">ğŸ“¬</div>
                    <h3 class="text-xl font-bold text-gray-700 mb-2">No Reports Available</h3>
                    <p class="text-gray-500 max-w-md mx-auto">No progress reports are available for your children at this time. Please check back later.</p>
                </div>
                
                <div id="reportContent" class="space-y-6">
                    <!-- Accordion reports will be inserted here by JavaScript -->
                </div>
            </div>
            
            <!-- â”€â”€ Academics Tab â”€â”€ -->
            <div id="academicsContentArea" class="hidden">
                <h2 class="section-title">Academic Progress &amp; Assignments</h2>
                <div id="academicsStudentDropdown" class="mb-6">
                    <!-- Student dropdown inserted by JS -->
                </div>
                <div id="academicsContent" class="card p-6 min-h-48">
                    <!-- Academics data inserted by JS -->
                </div>
            </div>
            
            <!-- â”€â”€ Rewards Tab â”€â”€ -->
            <div id="rewardsContentArea" class="hidden">
                <h2 class="section-title">Parent Referral Rewards</h2>
                <div id="rewardsContent" class="card p-6 min-h-48">
                    <!-- Rewards data inserted by JS -->
                </div>
            </div>

            <!-- â”€â”€ Enroll Tab â”€â”€ -->
            <div id="enrollContentArea" class="hidden">
                <!-- Enrollment form inserted by JS -->
            </div>

            <!-- â”€â”€ Settings (hidden, created by JS) â”€â”€ -->
            <div id="settingsContentArea" class="hidden"></div>

        </div><!-- end reportArea -->


        <!-- â•â•â•â•â•â•â•â•â•â• FEEDBACK MODAL â•â•â•â•â•â•â•â•â•â• -->
        <div id="feedbackModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center hidden z-50 p-4" style="backdrop-filter:blur(6px);">
            <div class="bg-white rounded-2xl p-6 md:p-8 max-w-2xl w-full mx-auto card-glow max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-gray-800" style="font-family:'Playfair Display',serif;">Send Feedback</h3>
                    <button onclick="hideFeedbackModal()" class="text-gray-400 hover:text-gray-700 text-2xl leading-none">&times;</button>
                </div>
                <p class="text-gray-500 mb-6 text-sm">We value your feedback! Please fill out the form below.</p>
                <div class="space-y-4">
                    <div>
                        <label for="feedbackCategory" class="block text-sm font-semibold text-gray-700 mb-2">Category *</label>
                        <select id="feedbackCategory" class="input-styled" required>
                            <option value="">Select category</option>
                            <option value="Feedback">General Feedback</option>
                            <option value="Request">Special Request</option>
                            <option value="Complaint">Complaint</option>
                            <option value="Suggestion">Suggestion</option>
                        </select>
                    </div>
                    <div>
                        <label for="feedbackPriority" class="block text-sm font-semibold text-gray-700 mb-2">Priority *</label>
                        <select id="feedbackPriority" class="input-styled" required>
                            <option value="">Select priority</option>
                            <option value="Low">Low</option>
                            <option value="Medium">Medium</option>
                            <option value="High">High</option>
                            <option value="Urgent">Urgent</option>
                        </select>
                    </div>
                    <div>
                        <label for="feedbackStudent" class="block text-sm font-semibold text-gray-700 mb-2">Regarding Student *</label>
                        <select id="feedbackStudent" class="input-styled" required>
                            <option value="">Select student</option>
                        </select>
                    </div>
                    <div>
                        <label for="feedbackMessage" class="block text-sm font-semibold text-gray-700 mb-2">Your Message *</label>
                        <textarea id="feedbackMessage" rows="5" placeholder="Please provide detailsâ€¦"
                                  class="input-styled preserve-whitespace" required></textarea>
                    </div>
                    <div class="flex flex-col sm:flex-row gap-2 pt-2">
                        <button id="submitFeedbackBtn" class="btn-primary flex-1 flex justify-center items-center gap-2">
                            <span id="submitFeedbackText">Submit Feedback</span>
                            <div id="submitFeedbackSpinner" class="loading-spinner hidden"></div>
                        </button>
                        <button onclick="hideFeedbackModal()" 
                                class="flex-1 bg-gray-100 text-gray-700 py-3 rounded-xl font-bold hover:bg-gray-200 transition-colors border border-gray-200">
                            Cancel
                        </button>
                    </div>
                </div>
                <p class="text-xs text-gray-400 text-center mt-4">Your feedback is important to us. We'll respond within 24â€“48 hours.</p>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â• ADMIN RESPONSES MODAL â•â•â•â•â•â•â•â•â•â• -->
        <div id="responsesModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center hidden z-50 p-4" style="backdrop-filter:blur(6px);">
            <div class="bg-white rounded-2xl p-6 md:p-8 max-w-4xl w-full mx-auto card-glow max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-gray-800" style="font-family:'Playfair Display',serif;">ğŸ“¨ Admin Responses</h3>
                    <button onclick="hideResponsesModal()" class="text-gray-400 hover:text-gray-700 text-2xl leading-none">&times;</button>
                </div>
                <p class="text-gray-500 mb-6 text-sm">Responses from our staff to your feedback.</p>
                <div id="responsesContent" class="space-y-4"></div>
                <div class="mt-6 text-center">
                    <button onclick="hideResponsesModal()" class="bg-gray-100 text-gray-700 px-6 py-2.5 rounded-xl font-bold hover:bg-gray-200 transition-colors border border-gray-200">Close</button>
                </div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â• PASSWORD RESET MODAL â•â•â•â•â•â•â•â•â•â• -->
        <div id="passwordResetModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center hidden z-50 p-4" style="backdrop-filter:blur(6px);">
            <div class="bg-white rounded-2xl p-6 md:p-8 max-w-md w-full mx-auto card-glow">
                <h3 class="text-2xl font-bold text-gray-800 mb-4 text-center" style="font-family:'Playfair Display',serif;">Reset Password</h3>
                <p class="text-gray-500 mb-6 text-center text-sm">Enter your email address to receive a password reset link.</p>
                <div class="space-y-4">
                    <div>
                        <label for="resetEmail" class="block text-sm font-semibold text-gray-700 mb-2">Email Address</label>
                        <input id="resetEmail" type="email" placeholder="Enter your registered email" class="input-styled" required>
                    </div>
                    <div class="flex flex-col sm:flex-row gap-2">
                        <button id="sendResetBtn" class="btn-primary flex-1 flex justify-center items-center gap-2">
                            <span id="sendResetText">Send Reset Link</span>
                            <div id="sendResetSpinner" class="loading-spinner hidden"></div>
                        </button>
                        <button id="cancelResetBtn" class="flex-1 bg-gray-100 text-gray-700 py-3 rounded-xl font-bold hover:bg-gray-200 transition-colors border border-gray-200">
                            Cancel
                        </button>
                    </div>
                </div>
                <div id="resetLoader" class="hidden text-center mt-4">
                    <div class="loading-spinner" style="border-color:rgba(16,185,129,.2);border-top-color:#059669;"></div>
                    <p class="text-green-700 font-semibold mt-2 text-sm">Sending reset linkâ€¦</p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-12 pb-8">
            <p class="text-green-800 font-bold text-sm" style="font-family:'Playfair Display',serif;">BLOOMING KIDS HOUSE</p>
            <p class="text-green-600 text-xs mt-1">Where Every Child Blossoms</p>
            <p class="text-gray-400 text-xs mt-3">
                <a href="#" onclick="showPrivacyPolicy();return false;" class="hover:text-green-600 transition-colors">Privacy Policy</a>
            </p>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â• COOKIE CONSENT BANNER â•â•â•â•â•â•â•â•â•â• -->
    <div id="privacyCookieBanner" style="display:none;position:fixed;bottom:0;left:0;right:0;z-index:99998;background:linear-gradient(135deg,#0f172a,#1e293b);color:#fff;padding:16px 20px;box-shadow:0 -4px 30px rgba(0,0,0,.4);">
        <div style="max-width:900px;margin:0 auto;display:flex;flex-wrap:wrap;align-items:center;gap:14px;">
            <div style="flex:1;min-width:260px;">
                <div style="font-family:'Playfair Display',serif;font-weight:700;font-size:1rem;margin-bottom:4px;">ğŸ”’ We value your privacy</div>
                <div style="font-family:'DM Sans',sans-serif;font-size:0.78rem;color:rgba(255,255,255,.65);line-height:1.55;">We use essential cookies for authentication and analytics cookies to improve your experience. We comply with NDPA, GDPR, and COPPA.
                    <a href="#" onclick="showPrivacyPolicy();return false;" style="color:#34d399;text-decoration:underline;font-weight:600;">Privacy Policy</a>
                </div>
            </div>
            <div style="display:flex;gap:8px;flex-shrink:0;">
                <button onclick="acceptPrivacyCookies()" style="background:linear-gradient(135deg,#059669,#10b981);color:#fff;border:none;padding:9px 20px;border-radius:10px;font-family:'DM Sans',sans-serif;font-weight:700;cursor:pointer;font-size:0.85rem;">Accept All</button>
                <button onclick="declinePrivacyCookies()" style="background:rgba(255,255,255,.1);color:#fff;border:1px solid rgba(255,255,255,.2);padding:9px 16px;border-radius:10px;font-family:'DM Sans',sans-serif;font-weight:600;cursor:pointer;font-size:0.85rem;">Essential Only</button>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â• PRIVACY POLICY MODAL â•â•â•â•â•â•â•â•â•â• -->
    <div id="privacyPolicyModal" style="display:none;position:fixed;inset:0;z-index:999999;background:rgba(0,0,0,.75);backdrop-filter:blur(8px);align-items:center;justify-content:center;padding:16px;">
        <div style="background:#fff;border-radius:22px;width:100%;max-width:680px;max-height:88vh;display:flex;flex-direction:column;overflow:hidden;box-shadow:0 40px 100px rgba(0,0,0,.5);">
            <div style="background:linear-gradient(135deg,#065f46,#059669,#34d399);padding:20px 24px;display:flex;align-items:center;justify-content:space-between;">
                <div style="display:flex;align-items:center;gap:10px;">
                    <span style="font-size:1.4rem;">ğŸ”’</span>
                    <div style="color:#fff;font-family:'Playfair Display',serif;font-weight:700;font-size:1.05rem;">Privacy Policy</div>
                </div>
                <button onclick="closePrivacyPolicy()" style="background:rgba(255,255,255,.2);border:none;color:#fff;width:34px;height:34px;border-radius:50%;font-size:1rem;cursor:pointer;line-height:1;">âœ•</button>
            </div>
            <div style="flex:1;overflow-y:auto;padding:26px;font-family:'DM Sans',sans-serif;">
                <p style="font-size:0.78rem;color:#94a3b8;margin-bottom:18px;">Last updated: January 2025 | Blooming Kids House</p>
                <h3 style="font-family:'Playfair Display',serif;font-weight:700;color:#0f172a;margin:0 0 8px;">Data We Collect</h3>
                <p style="font-size:0.875rem;color:#475569;margin-bottom:18px;line-height:1.65;">We collect personal information you provide during registration (name, email, phone number) and usage data (session activity, login times). For students under 13, we collect only what is strictly necessary, in compliance with COPPA.</p>
                <h3 style="font-family:'Playfair Display',serif;font-weight:700;color:#0f172a;margin:0 0 8px;">How We Use Your Data</h3>
                <p style="font-size:0.875rem;color:#475569;margin-bottom:18px;line-height:1.65;">Your data is used solely to provide tutoring services, match students with tutors, track academic progress, and communicate with parents/guardians. We do not sell your data to third parties.</p>
                <h3 style="font-family:'Playfair Display',serif;font-weight:700;color:#0f172a;margin:0 0 8px;">Your Rights (NDPA / GDPR)</h3>
                <ul style="font-size:0.875rem;color:#475569;margin-bottom:18px;padding-left:18px;line-height:2.2;">
                    <li>Access your personal data</li>
                    <li>Request correction or deletion</li>
                    <li>Withdraw consent at any time</li>
                    <li>Data portability</li>
                    <li>Lodge a complaint with the supervisory authority</li>
                </ul>
                <h3 style="font-family:'Playfair Display',serif;font-weight:700;color:#0f172a;margin:0 0 8px;">Children Privacy (COPPA)</h3>
                <p style="font-size:0.875rem;color:#475569;margin-bottom:18px;line-height:1.65;">We never knowingly collect personal data from children under 13 without verifiable parental consent. Parents may review, update, or delete their child's information by contacting us.</p>
                <h3 style="font-family:'Playfair Display',serif;font-weight:700;color:#0f172a;margin:0 0 8px;">Contact Us</h3>
                <p style="font-size:0.875rem;color:#475569;line-height:1.65;">For data requests or privacy concerns: <strong>privacy@bloomingkidshouse.com</strong></p>
            </div>
            <div style="padding:14px 24px;border-top:1px solid #f1f5f9;display:flex;justify-content:flex-end;">
                <button onclick="closePrivacyPolicy()" style="background:linear-gradient(135deg,#065f46,#059669);color:#fff;border:none;padding:10px 24px;border-radius:12px;font-family:'DM Sans',sans-serif;font-weight:700;cursor:pointer;font-size:0.9rem;">Close</button>
            </div>
        </div>
    </div>

    <script>
    // â”€â”€ Cookie Consent Logic â”€â”€
    (function() {
        var KEY = "bkh_cookie_consent";
        window.acceptPrivacyCookies  = function() { localStorage.setItem(KEY,'all');       document.getElementById('privacyCookieBanner').style.display='none'; };
        window.declinePrivacyCookies = function() { localStorage.setItem(KEY,'essential'); document.getElementById('privacyCookieBanner').style.display='none'; };
        window.showPrivacyPolicy  = function() { var m=document.getElementById('privacyPolicyModal'); if(m) m.style.display='flex'; };
        window.closePrivacyPolicy = function() { var m=document.getElementById('privacyPolicyModal'); if(m) m.style.display='none'; };
        document.addEventListener('DOMContentLoaded', function() {
            if (!localStorage.getItem(KEY)) document.getElementById('privacyCookieBanner').style.display='block';
        });
    })();
    </script>

    <script src="parent.js"></script>
</body>
</html>
