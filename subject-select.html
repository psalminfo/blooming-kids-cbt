<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Select Subject - Blooming Kids House</title>
  <link rel="icon" href="favicon.ico" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" />
  <link rel="stylesheet" href="style.css" />
</head>
<body class="bg-green-50 min-h-screen flex items-center justify-center">

  <div class="bg-white p-8 rounded-xl shadow-xl w-full max-w-md">
        <div class="flex justify-between items-center mb-6">
      <h2 class="text-2xl font-bold text-green-800">Select a Subject</h2>
            <button onclick="logout()" class="bg-yellow-400 text-white px-4 py-2 rounded hover:bg-yellow-500 text-sm">Logout</button>
    </div>
        <div id="subjectButtons" class="space-y-4">
          </div>
    <p class="text-xs text-center mt-8 text-gray-600">POWERED BY <span style="color:#FFEB3B">POG</span></p>
  </div>

  <script>
    // Fetch and parse the student data object from localStorage
    const studentDataString = localStorage.getItem('studentData');
    const studentData = JSON.parse(studentDataString);
    const subjectButtonsDiv = document.getElementById('subjectButtons');

    // Essential data check
    if (!studentData || !studentData.grade) {
      alert("Missing student info. Please log in again.");
      window.location.href = "index.html";
    }

    // Ensure grade is treated as an integer for comparison
    const grade = parseInt(studentData.grade);

    // Function to handle logout
    function logout() {
        localStorage.clear();
        window.location.href = "index.html";
    }

    function goToSubject(subject) {
      // Pass all required student data along with the subject via URL parameters
      const params = new URLSearchParams({
        subject: subject,
        studentName: studentData.studentName || 'Student', // Fallback for studentName
        parentEmail: studentData.parentEmail,
        grade: studentData.grade,
        tutorId: studentData.tutorId // Assuming tutorId is also in studentData
      });
      window.location.href = `student.html?${params.toString()}`;
    }

    // --- LOGIC TO RESTRICT SUBJECTS TO GRADES 3 THROUGH 6 ---
    if (grade >= 3 && grade <= 6) {
        // Subjects available for Grades 3-6
        const subjects = [
            { id: 'math', name: 'Math' },
            { id: 'ela', name: 'English Language Arts' },
            { id: 'science', name: 'Science' }
        ];

        // Generate the buttons for the allowed subjects
        subjectButtonsDiv.innerHTML = subjects.map(subject => 
            `<button onclick="goToSubject('${subject.id}')" class="bg-green-600 text-white w-full py-2 rounded hover:bg-green-700">${subject.name}</button>`
        ).join('');

    } else {
        // Display a message for non-supported grades
        subjectButtonsDiv.innerHTML = `
            <p class="text-lg text-red-500 font-semibold">
                Subjects not yet configured for Grade ${studentData.grade}.
            </p>
            <p class="text-sm text-gray-500 mt-2">
                This app currently supports Maths, English, and Science for Grades 3 through 6.
            </p>
        `;
    }
    // --- END LOGIC ---
  </script>

</body>
</html>
